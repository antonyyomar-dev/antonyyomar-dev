Query 1: Obtener todos los vendedores que tienen una reputación mayor o igual a 4.5.

use("SubaTecc");
db.detalle_vendedor.find({
  reputacion_promedio: { $gte: 4.5 }
})


Query 2:Contar el número total de subastas finalizadas, agrupadas por el año de su fecha de inicio

use('SubaTecc')
db.subasta.aggregate([
  { $match: { estado: "finalizada" } },
  {
    $group: {
      _id: { $year: "$fecha_inicio" },
      total_subastas_finalizadas: { $sum: 1 }
    }
  },
  { $sort: { _id: 1 } }
])


Query 3: Mostrar los compradores junto con la cantidad de subastas que han ganado.

use("SubaTecc");
db.detalle_subasta.aggregate([
  { $match: { estado: "finalizada" } },
  { $unwind: "$ofertas" },
  { $sort: { "_id": 1, "ofertas.monto_ofertado": -1 } },
  {
    $group: {
      _id: "$_id",
      ganador: { $first: "$ofertas.comprador" }
    }
  },
  {
    $group: {
      _id: "$ganador.id",
      nombre: { $first: "$ganador.nombre" },
      total_ganadas: { $sum: 1 }
    }
  }
])



Query 4:Mostrar los compradores que han realizado más de 3 ofertas en total.

use("SubaTecc");
db.detalle_subasta.aggregate([
  { $unwind: "$ofertas" },
  {
    $group: {
      _id: "$ofertas.comprador.id",
      nombre: { $first: "$ofertas.comprador.nombre" },
      total_ofertas: { $sum: 1 }
    }
  },
  { $match: { total_ofertas: { $gt: 3 } } }
])



Query 5: Mostrar los vendedores que tienen al menos un producto subastado en la categoría “Electrohogar”.

use("SubaTecc");
db.detalle_subasta.aggregate([
  { $unwind: "$producto" },
  { $match: { "producto.categoria": "Electrohogar" } },
  {
    $project: {
      _id: 0,
      vendedor: "$producto.vendedor.nombre",
      categoria: "$producto.categoria"
    }
  }
])
